<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="100%" height="100%" fill="#f8f9fa" />

  <!-- Styles -->
  <style>
    .box { fill: #e9ecef; stroke: #343a40; stroke-width: 2; rx: 10; ry: 10; }
    .text { font-family: Arial, sans-serif; font-size: 14px; fill: #212529; text-anchor: middle; dominant-baseline: middle; }
    .arrow { stroke: #343a40; stroke-width: 2; marker-end: url(#arrowhead); }
    .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #212529; text-anchor: middle; }
  </style>

  <!-- Arrowhead definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#343a40" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="400" y="30" class="title">Multi-Modal Gait Recognition Architecture</text>

  <!-- Inputs -->
  <rect x="50" y="100" width="150" height="60" class="box" fill="#dbe4ff" />
  <text x="125" y="130" class="text">Input: Silhouettes</text>
  <text x="125" y="150" class="text" font-size="10">(T x H x W)</text>

  <rect x="50" y="350" width="150" height="60" class="box" fill="#dbe4ff" />
  <text x="125" y="380" class="text">Input: Skeletons</text>
  <text x="125" y="400" class="text" font-size="10">(T x V x C)</text>

  <!-- Visual Branch -->
  <rect x="250" y="80" width="200" height="100" class="box" fill="#fff3cd" />
  <text x="350" y="110" class="text" font-weight="bold">Visual Branch</text>
  <text x="350" y="130" class="text">CNN Backbone</text>
  <text x="350" y="150" class="text">Set Pooling</text>

  <!-- Skeleton Branch -->
  <rect x="250" y="330" width="200" height="100" class="box" fill="#d4edda" />
  <text x="350" y="360" class="text" font-weight="bold">Skeleton Branch</text>
  <text x="350" y="380" class="text">ST-GCN Layers</text>
  <text x="350" y="400" class="text">Global Pooling</text>

  <!-- Features -->
  <rect x="500" y="100" width="100" height="60" class="box" />
  <text x="550" y="130" class="text">Visual Feat</text>

  <rect x="500" y="350" width="100" height="60" class="box" />
  <text x="550" y="380" class="text">Skel Feat</text>

  <!-- Fusion -->
  <rect x="650" y="200" width="120" height="150" class="box" fill="#e2e3e5" />
  <text x="710" y="240" class="text" font-weight="bold">Fusion</text>
  <text x="710" y="270" class="text">Concatenate</text>
  <text x="710" y="300" class="text">FC Layer</text>

  <!-- Output -->
  <rect x="650" y="450" width="120" height="50" class="box" fill="#f8d7da" />
  <text x="710" y="475" class="text">Loss (CE + Triplet)</text>

  <!-- Connections -->
  <!-- Visual Path -->
  <line x1="200" y1="130" x2="250" y2="130" class="arrow" />
  <line x1="450" y1="130" x2="500" y2="130" class="arrow" />
  <line x1="600" y1="130" x2="650" y2="220" class="arrow" />

  <!-- Skeleton Path -->
  <line x1="200" y1="380" x2="250" y2="380" class="arrow" />
  <line x1="450" y1="380" x2="500" y2="380" class="arrow" />
  <line x1="600" y1="380" x2="650" y2="330" class="arrow" />

  <!-- Output Path -->
  <line x1="710" y1="350" x2="710" y2="450" class="arrow" />

</svg>
